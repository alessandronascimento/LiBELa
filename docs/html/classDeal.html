<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LIBELA: Deal Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Deal Class Reference</h1><!-- doxytag: class="Deal" -->
<p>This class was written to use the Density Estination Algorithm to optimize binding energy after a rough ligand docking based on ligand similarity and using a reference small molecule to 'guide' the docking. The density estimation here uses gaussian estimates of rotation angles and translations.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Deal_8h_source.html">Deal.h</a>&gt;</code></p>

<p><a href="classDeal-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#acc21499a89384247e4fb15568cf17982">Deal</a> (<a class="el" href="classMol2.html">Mol2</a> *_Rec, <a class="el" href="classMol2.html">Mol2</a> *_Lig, <a class="el" href="classPARSER.html">PARSER</a> *Input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2e59a24920d5ccdd893c0962b92c61af"></a><!-- doxytag: member="Deal::~Deal" ref="a2e59a24920d5ccdd893c0962b92c61af" args="()" -->
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a2e59a24920d5ccdd893c0962b92c61af">~Deal</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deconstructor. Deletes the gsl rng interface;. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#ab36a3bcdb00eebadca5d8e1b83903afe">sort_array</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abbff975a52cf2cf3c67af7c23ad909ff"></a><!-- doxytag: member="Deal::sort_and_evaluate" ref="abbff975a52cf2cf3c67af7c23ad909ff" args="(double *mu, int iteration)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#abbff975a52cf2cf3c67af7c23ad909ff">sort_and_evaluate</a> (double *<a class="el" href="classDeal.html#a3ebd25a0952e605a7ba348081ca02dff">mu</a>, int iteration)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method iterates PARSER::deal_generation 'generations', each generation with <a class="el" href="classPARSER.html#afe06b419ab83ef6d8541b783f7cafe8f" title="Size of population for density estimation algorithm.">PARSER::deal_pop_size</a> sampling;. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a61921feaaf8c68aec2964013fdea0c12"></a><!-- doxytag: member="Deal::update_mu" ref="a61921feaaf8c68aec2964013fdea0c12" args="(int top_ranked)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a61921feaaf8c68aec2964013fdea0c12">update_mu</a> (int top_ranked)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Here, the estimates are computed (simple averages) for further use to sample angles and rotations in a gaussian distribution centered on mu;. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="add1bf8643006b1c33cf41072e023e128"></a><!-- doxytag: member="Deal::iterate" ref="add1bf8643006b1c33cf41072e023e128" args="(PARSER *Input)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#add1bf8643006b1c33cf41072e023e128">iterate</a> (<a class="el" href="classPARSER.html">PARSER</a> *Input)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method couples iterations and mu updates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83199504a901a2844d182196b1d644f3"></a><!-- doxytag: member="Deal::evaluate_energy" ref="a83199504a901a2844d182196b1d644f3" args="(QVector&lt; double &gt; temp)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>evaluate_energy</b> (QVector&lt; double &gt; temp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8737d935dbc8958518c16a24b4b26257"></a><!-- doxytag: member="Deal::define_chunck_sizes" ref="a8737d935dbc8958518c16a24b4b26257" args="(void)" -->
vector&lt; int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>define_chunck_sizes</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af455962f09d71519e0651b7bc5822b2f"></a><!-- doxytag: member="Deal::rototranslate" ref="af455962f09d71519e0651b7bc5822b2f" args="(Mol2 *Lig, double alpha, double beta, double gamma, double transx, double transy, double transz)" -->
vector&lt; vector&lt; double &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>rototranslate</b> (<a class="el" href="classMol2.html">Mol2</a> *Lig, double alpha, double beta, double gamma, double transx, double transy, double transz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4c14bc771b0b80045bb30224e8c4eb30"></a><!-- doxytag: member="Deal::compute_com" ref="a4c14bc771b0b80045bb30224e8c4eb30" args="(Mol2 *Cmol)" -->
vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>compute_com</b> (<a class="el" href="classMol2.html">Mol2</a> *Cmol)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a413250a08bd09f48c746b046f2fe832f">compute_ene_softcore_solvation</a> (<a class="el" href="classMol2.html">Mol2</a> *Rec, <a class="el" href="classMol2.html">Mol2</a> *Lig, <a class="el" href="classPARSER.html">PARSER</a> *Input, vector&lt; vector&lt; double &gt; &gt;coords)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab47d9b35bd969fb1dda4ae259ff818a2"></a><!-- doxytag: member="Deal::distance_squared" ref="ab47d9b35bd969fb1dda4ae259ff818a2" args="(double x1, double x2, double y1, double y2, double z1, double z2)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>distance_squared</b> (double x1, double x2, double y1, double y2, double z1, double z2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8769484e9659041ff51605729733635c"></a><!-- doxytag: member="Deal::distance" ref="a8769484e9659041ff51605729733635c" args="(double x1, double x2, double y1, double y2, double z1, double z2)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>distance</b> (double x1, double x2, double y1, double y2, double z1, double z2)</td></tr>
<tr><td colspan="2"><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a94b3deb88235446e08a13d12103fc441"></a><!-- doxytag: member="Deal::population_size" ref="a94b3deb88235446e08a13d12103fc441" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a94b3deb88235446e08a13d12103fc441">population_size</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of population. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3f7ad66c44e737d0c02c99c1eb017b6"></a><!-- doxytag: member="Deal::T" ref="ad3f7ad66c44e737d0c02c99c1eb017b6" args="" -->
const gsl_rng_type *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#ad3f7ad66c44e737d0c02c99c1eb017b6">T</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GSL type. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16ff5bce803143e1f731618c0df7dcf6"></a><!-- doxytag: member="Deal::r" ref="a16ff5bce803143e1f731618c0df7dcf6" args="" -->
gsl_rng *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a16ff5bce803143e1f731618c0df7dcf6">r</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GSL Random number generator interface. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ebd25a0952e605a7ba348081ca02dff"></a><!-- doxytag: member="Deal::mu" ref="a3ebd25a0952e605a7ba348081ca02dff" args="" -->
double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a3ebd25a0952e605a7ba348081ca02dff">mu</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Double array used to keep 6 variables: mean for alpha, beta, gamma, x, y and z;. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7f25c3c7056763a79c9e6924c36fc4fe"></a><!-- doxytag: member="Deal::sigma" ref="a7f25c3c7056763a79c9e6924c36fc4fe" args="" -->
double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a7f25c3c7056763a79c9e6924c36fc4fe">sigma</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Double array used to keep sigmas for gaussian distribution generations. Initially defined as {60.0, 30.0,0 60.0, 1.0, 1.0, 1.0}. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11b9859d6624186ecc75aad21b30791a"></a><!-- doxytag: member="Deal::rotrans" ref="a11b9859d6624186ecc75aad21b30791a" args="" -->
vector&lt; vector&lt; double &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a11b9859d6624186ecc75aad21b30791a">rotrans</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">C++ vector with the rotations and translations (angles and displacements). Important to define the next estimate. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7088d41426d89d85d70893b8aae6c171"></a><!-- doxytag: member="Deal::energies" ref="a7088d41426d89d85d70893b8aae6c171" args="" -->
vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeal.html#a7088d41426d89d85d70893b8aae6c171">energies</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">C++ vector with the energies of each 'pose', defined as a set of 3 angles and translation in 3 directions. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2395c32eb3258cbe9835caa3c774086b"></a><!-- doxytag: member="Deal::Rec" ref="a2395c32eb3258cbe9835caa3c774086b" args="" -->
<a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>Rec</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3fc38342edb04056cf06023e1ac942b"></a><!-- doxytag: member="Deal::Lig" ref="ae3fc38342edb04056cf06023e1ac942b" args="" -->
<a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>Lig</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7a0b4be112eef19bdad0e31de7364861"></a><!-- doxytag: member="Deal::Input" ref="a7a0b4be112eef19bdad0e31de7364861" args="" -->
<a class="el" href="classPARSER.html">PARSER</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>Input</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3777429077011fe2e04ef41266d7dc93"></a><!-- doxytag: member="Deal::slices" ref="a3777429077011fe2e04ef41266d7dc93" args="" -->
vector&lt; int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>slices</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afcc9298da87fc0bdd80a2cf8201d7089"></a><!-- doxytag: member="Deal::chunck_size" ref="afcc9298da87fc0bdd80a2cf8201d7089" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>chunck_size</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0fa1dcafa8e1d88a5ac7cf88a27b2f87"></a><!-- doxytag: member="Deal::time_i" ref="a0fa1dcafa8e1d88a5ac7cf88a27b2f87" args="" -->
clock_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>time_i</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1469a187f67215e4e10a2f5f94c3b16d"></a><!-- doxytag: member="Deal::time_f" ref="a1469a187f67215e4e10a2f5f94c3b16d" args="" -->
clock_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>time_f</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7cb8a68a46ce64218c0328b808c10357"></a><!-- doxytag: member="Deal::final_coords" ref="a7cb8a68a46ce64218c0328b808c10357" args="" -->
vector&lt; vector&lt; double &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>final_coords</b></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class was written to use the Density Estination Algorithm to optimize binding energy after a rough ligand docking based on ligand similarity and using a reference small molecule to 'guide' the docking. The density estimation here uses gaussian estimates of rotation angles and translations. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="acc21499a89384247e4fb15568cf17982"></a><!-- doxytag: member="Deal::Deal" ref="acc21499a89384247e4fb15568cf17982" args="(Mol2 *_Rec, Mol2 *_Lig, PARSER *Input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Deal::Deal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td>
          <td class="paramname"> <em>_Rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td>
          <td class="paramname"> <em>_Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPARSER.html">PARSER</a> *&nbsp;</td>
          <td class="paramname"> <em>Input</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor. Here, the other methods are also called. So, calling the constructor, should be all that is necessary to perform the optimization. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a413250a08bd09f48c746b046f2fe832f"></a><!-- doxytag: member="Deal::compute_ene_softcore_solvation" ref="a413250a08bd09f48c746b046f2fe832f" args="(Mol2 *Rec, Mol2 *Lig, PARSER *Input, vector&lt; vector&lt; double &gt; &gt;coords)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Deal::compute_ene_softcore_solvation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td>
          <td class="paramname"> <em>Rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMol2.html">Mol2</a> *&nbsp;</td>
          <td class="paramname"> <em>Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPARSER.html">PARSER</a> *&nbsp;</td>
          <td class="paramname"> <em>Input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; vector&lt; double &gt; &gt;&nbsp;</td>
          <td class="paramname"> <em>coords</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>electrostactic energy (softcore)</p>
<p>VDW energy (softcore)</p>
<p>Solvation energy</p>
<p>electrostactic energy (softcore)</p>
<p>VDW energy (softcore) </p>
</p>

</div>
</div>
<a class="anchor" id="ab36a3bcdb00eebadca5d8e1b83903afe"></a><!-- doxytag: member="Deal::sort_array" ref="ab36a3bcdb00eebadca5d8e1b83903afe" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Deal::sort_array </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method sorts the energies array together with the angles/translations. It's important to select the top ranked rototranslations and define the next estimative. Here, we used N**2 comparisong. This method can be further optimized. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/share/apps/iMcLiBELa/trunk/src/LiBELa/<a class="el" href="Deal_8h_source.html">Deal.h</a></li>
<li>/share/apps/iMcLiBELa/trunk/src/LiBELa/Deal.cpp</li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 26 Jul 2018 for LIBELA by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
